<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets Data</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>
  <nav class="navbar navbar-dark bg-dark">
    <div class="container-fluid">
      <span class="navbar-brand">My Website</span>
    </div>
  </nav>

  <header class="bg-primary text-white text-center p-4">
    <h1>ข้อมูลจาก Google Sheets</h1>
  </header>

  <div class="container my-5">
    <table class="table table-bordered" id="data-table">
      <!-- Data จะถูกใส่ที่นี่ -->
    </table>
  </div>

  <footer class="bg-dark text-white text-center p-3">
    © 2024 My Website
  </footer>

  <script>
    const SHEET_ID = '1aTyzgqxB_00JRFPo0bHa51o5K_4SDjHgGzONofNmXmE';
    const API_KEY = 'AIzaSyDG14fqJaf81IbjlVv2Q_4ofYRlySJjaUk';
    const SHEET_NAME = 'ProjectStd'; // หรือชื่อ Sheet ที่ใช้งานจริง

    const API_URL = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;

    fetch(API_URL)
      .then(response => response.json())
      .then(data => {
        const table = document.getElementById("data-table");
        if (!data.values) {
          table.innerHTML = "<tr><td colspan='99'>ไม่พบข้อมูล</td></tr>";
          return;
        }

        data.values.forEach((row, rowIndex) => {
          const tr = document.createElement("tr");
          row.forEach(cell => {
            const cellTag = rowIndex === 0 ? "th" : "td";
            const td = document.createElement(cellTag);
            td.textContent = cell;
            tr.appendChild(td);
          });
          table.appendChild(tr);
        });
      })
      .catch(error => {
        console.error("เกิดข้อผิดพลาด:", error);
        document.getElementById("data-table").innerHTML = "<tr><td colspan='99'>ไม่สามารถโหลดข้อมูลได้</td></tr>";
      });
  </script>
</body>
</html>
